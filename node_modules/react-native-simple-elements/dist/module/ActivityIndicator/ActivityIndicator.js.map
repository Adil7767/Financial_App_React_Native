{"version":3,"sources":["ActivityIndicator.tsx"],"names":["React","Animated","Easing","Platform","StyleSheet","ThemeContext","styled","ActivityIndicatorContainer","View","DURATION","ActivityIndicator","animating","color","indicatorColor","hidesWhenStopped","size","indicatorSize","style","theme","useContext","current","timer","useRef","Value","fade","rotation","undefined","animation","scale","startRotation","useCallback","timing","duration","toValue","isInteraction","useNativeDriver","start","setValue","loop","stopRotation","stop","useEffect","easing","linear","OS","colors","primary","frames","bezier","layerStyle0","absoluteFillObject","justifyContent","alignItems","containerStyle","width","height","overflow","opacity","map","index","inputRange","Array","from","_","frameIndex","outputRange","progress","direction","layerStyle","transform","rotate","interpolate","viewportStyle","translateY","offsetStyle","top","lineStyle","borderColor","borderWidth","borderRadius"],"mappings":";;;;;;;;;;;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SACIC,QADJ,EAEIC,MAFJ,EAGIC,QAHJ,EAKIC,UALJ,QAQO,cARP;AASA,SAAuBC,YAAvB,QAA2C,mBAA3C;AACA,OAAOC,MAAP,MAAmB,0BAAnB;AAEA,MAAMC,0BAA0B,GAAGD,MAAM,CAACE,IAAV,mBAAhC;AA6BA,MAAMC,QAAQ,GAAG,IAAjB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,MAAMC,iBAAiB,GAAG,CAAC;AACvBC,EAAAA,SAAS,GAAG,IADW;AAEvBC,EAAAA,KAAK,EAAEC,cAFgB;AAGvBC,EAAAA,gBAAgB,GAAG,IAHI;AAIvBC,EAAAA,IAAI,EAAEC,aAAa,GAAG,OAJC;AAKvBC,EAAAA;AALuB,CAAD,KAMb;AACT,QAAMC,KAAK,GAAGlB,KAAK,CAACmB,UAAN,CAAiBd,YAAjB,CAAd;AAEA,QAAM;AAAEe,IAAAA,OAAO,EAAEC;AAAX,MAAqBrB,KAAK,CAACsB,MAAN,CACvB,IAAIrB,QAAQ,CAACsB,KAAb,CAAmB,CAAnB,CADuB,CAA3B;AAGA,QAAM;AAAEH,IAAAA,OAAO,EAAEI;AAAX,MAAoBxB,KAAK,CAACsB,MAAN,CACtB,IAAIrB,QAAQ,CAACsB,KAAb,CAAmB,CAACZ,SAAD,IAAcG,gBAAd,GAAiC,CAAjC,GAAqC,CAAxD,CADsB,CAA1B;AAIA,QAAMW,QAAQ,GAAGzB,KAAK,CAACsB,MAAN,CACbI,SADa,CAAjB;AAIA,QAAM;AACFC,IAAAA,SAAS,EAAE;AAAEC,MAAAA;AAAF;AADT,MAEFV,KAFJ;AAIA,QAAMW,aAAa,GAAG7B,KAAK,CAAC8B,WAAN,CAAkB,MAAM;AAC1C;AACA7B,IAAAA,QAAQ,CAAC8B,MAAT,CAAgBP,IAAhB,EAAsB;AAClBQ,MAAAA,QAAQ,EAAE,MAAMJ,KADE;AAElBK,MAAAA,OAAO,EAAE,CAFS;AAGlBC,MAAAA,aAAa,EAAE,KAHG;AAIlBC,MAAAA,eAAe,EAAE;AAJC,KAAtB,EAKGC,KALH,GAF0C,CAS1C;;AACA,QAAIX,QAAQ,CAACL,OAAb,EAAsB;AAClBC,MAAAA,KAAK,CAACgB,QAAN,CAAe,CAAf,EADkB,CAElB;;AACApC,MAAAA,QAAQ,CAACqC,IAAT,CAAcb,QAAQ,CAACL,OAAvB,EAAgCgB,KAAhC;AACH;AACJ,GAfqB,EAenB,CAACR,KAAD,EAAQJ,IAAR,EAAcH,KAAd,CAfmB,CAAtB;;AAiBA,QAAMkB,YAAY,GAAG,MAAM;AACvB,QAAId,QAAQ,CAACL,OAAb,EAAsB;AAClBK,MAAAA,QAAQ,CAACL,OAAT,CAAiBoB,IAAjB;AACH;AACJ,GAJD;;AAMAxC,EAAAA,KAAK,CAACyC,SAAN,CAAgB,MAAM;AAClB,QAAIhB,QAAQ,CAACL,OAAT,KAAqBM,SAAzB,EAAoC;AAChC;AACAD,MAAAA,QAAQ,CAACL,OAAT,GAAmBnB,QAAQ,CAAC8B,MAAT,CAAgBV,KAAhB,EAAuB;AACtCW,QAAAA,QAAQ,EAAEvB,QAD4B;AAEtCiC,QAAAA,MAAM,EAAExC,MAAM,CAACyC,MAFuB;AAGtC;AACAR,QAAAA,eAAe,EAAEhC,QAAQ,CAACyC,EAAT,KAAgB,KAJK;AAKtCX,QAAAA,OAAO,EAAE,CAL6B;AAMtCC,QAAAA,aAAa,EAAE;AANuB,OAAvB,CAAnB;AAQH;;AAED,QAAIvB,SAAJ,EAAe;AACXkB,MAAAA,aAAa;AAChB,KAFD,MAEO,IAAIf,gBAAJ,EAAsB;AACzB;AACAb,MAAAA,QAAQ,CAAC8B,MAAT,CAAgBP,IAAhB,EAAsB;AAClBQ,QAAAA,QAAQ,EAAE,MAAMJ,KADE;AAElBK,QAAAA,OAAO,EAAE,CAFS;AAGlBE,QAAAA,eAAe,EAAE,IAHC;AAIlBD,QAAAA,aAAa,EAAE;AAJG,OAAtB,EAKGE,KALH,CAKSG,YALT;AAMH,KARM,MAQA;AACHA,MAAAA,YAAY;AACf;AACJ,GA1BD,EA0BG,CAAC5B,SAAD,EAAYa,IAAZ,EAAkBV,gBAAlB,EAAoCe,aAApC,EAAmDD,KAAnD,EAA0DP,KAA1D,CA1BH;AA4BA,QAAMT,KAAK,GAAGC,cAAc,IAAIK,KAAK,CAAC2B,MAAN,CAAaC,OAA7C;AACA,QAAM/B,IAAI,GACN,OAAOC,aAAP,KAAyB,QAAzB,GACMA,aAAa,KAAK,OAAlB,GACI,EADJ,GAEI,EAHV,GAIMA,aAAa,GACTA,aADS,GAET,EAPd;AASA,QAAM+B,MAAM,GAAI,KAAKtC,QAAN,GAAkB,IAAjC;AACA,QAAMiC,MAAM,GAAGxC,MAAM,CAAC8C,MAAP,CAAc,GAAd,EAAmB,GAAnB,EAAwB,GAAxB,EAA6B,GAA7B,CAAf;AACA,QAAMC,WAAW,GAAG,EAChB,GAAG7C,UAAU,CAAC8C,kBADE;AAEhBC,IAAAA,cAAc,EAAE,QAFA;AAGhBC,IAAAA,UAAU,EAAE;AAHI,GAApB;AAKA,QAAMC,cAAc,GAAG;AACnBC,IAAAA,KAAK,EAAEvC,IADY;AAEnBwC,IAAAA,MAAM,EAAExC,IAAI,GAAG,CAFI;AAGnByC,IAAAA,QAAQ,EAAE;AAHS,GAAvB;AAMA,sBACI,oBAAC,0BAAD;AACI,IAAA,UAAU,MADd;AAEI,IAAA,iBAAiB,EAAC,aAFtB;AAGI,IAAA,KAAK,EAAEvC;AAHX,kBAKI,oBAAC,QAAD,CAAU,IAAV;AACI,IAAA,KAAK,EAAE,CAAC;AAAEqC,MAAAA,KAAK,EAAEvC,IAAT;AAAewC,MAAAA,MAAM,EAAExC,IAAvB;AAA6B0C,MAAAA,OAAO,EAAEjC;AAAtC,KAAD,CADX;AAEI,IAAA,WAAW,EAAE;AAFjB,KAIK,CAAC,CAAD,EAAI,CAAJ,EAAOkC,GAAP,CAAYC,KAAD,IAAW;AACnB;AACA,UAAMC,UAAU,GAAGC,KAAK,CAACC,IAAN,CACf,IAAID,KAAJ,CAAUd,MAAV,CADe,EAEf,CAACgB,CAAD,EAAIC,UAAJ,KAAmBA,UAAU,IAAIjB,MAAM,GAAG,CAAb,CAFd,CAAnB;AAIA,UAAMkB,WAAW,GAAGJ,KAAK,CAACC,IAAN,CAAW,IAAID,KAAJ,CAAUd,MAAV,CAAX,EAA8B,CAACgB,CAAD,EAAIC,UAAJ,KAAmB;AACjE,UAAIE,QAAQ,GAAI,IAAIF,UAAL,IAAoBjB,MAAM,GAAG,CAA7B,CAAf;AACA,YAAMtB,QAAQ,GAAGkC,KAAK,GAAG,EAAE,MAAM,EAAR,CAAH,GAAiB,EAAE,MAAM,EAAR,CAAvC;;AAEA,UAAIO,QAAQ,GAAG,GAAf,EAAoB;AAChBA,QAAAA,QAAQ,GAAG,MAAMA,QAAjB;AACH;;AAED,YAAMC,SAAS,GAAGR,KAAK,GAAG,CAAC,CAAJ,GAAQ,CAAC,CAAhC;AAEA,uBAAUQ,SAAS,IAAI,MAAM,EAAV,CAAT,GAAyBzB,MAAM,CAACwB,QAAD,CAA/B,GAA4CzC,QAAtD;AACH,KAXmB,CAApB;AAaA,UAAM2C,UAAU,GAAG;AACfd,MAAAA,KAAK,EAAEvC,IADQ;AAEfwC,MAAAA,MAAM,EAAExC,IAFO;AAGfsD,MAAAA,SAAS,EAAE,CACP;AACIC,QAAAA,MAAM,EAAEjD,KAAK,CAACkD,WAAN,CAAkB;AACtBX,UAAAA,UAAU,EAAE,CAAC,CAAD,EAAI,CAAJ,CADU;AAEtBK,UAAAA,WAAW,EAAE,WAAI,IAAI,EAAJ,GAAS,EAAb,oBAAyB,IAAI,GAAJ,GAAU,EAAV,GAAe,EAAxC;AAFS,SAAlB;AADZ,OADO;AAHI,KAAnB;AAaA,UAAMO,aAAa,GAAG;AAClBlB,MAAAA,KAAK,EAAEvC,IADW;AAElBwC,MAAAA,MAAM,EAAExC,IAFU;AAGlBsD,MAAAA,SAAS,EAAE,CACP;AACII,QAAAA,UAAU,EAAEd,KAAK,GAAG,CAAC5C,IAAD,GAAQ,CAAX,GAAe;AADpC,OADO,EAIP;AACIuD,QAAAA,MAAM,EAAEjD,KAAK,CAACkD,WAAN,CAAkB;AAAEX,UAAAA,UAAF;AAAcK,UAAAA;AAAd,SAAlB;AADZ,OAJO;AAHO,KAAtB;AAaA,UAAMS,WAAW,GAAGf,KAAK,GAAG;AAAEgB,MAAAA,GAAG,EAAE5D,IAAI,GAAG;AAAd,KAAH,GAAuB,IAAhD;AAEA,UAAM6D,SAAS,GAAG;AACdtB,MAAAA,KAAK,EAAEvC,IADO;AAEdwC,MAAAA,MAAM,EAAExC,IAFM;AAGd8D,MAAAA,WAAW,EAAEjE,KAHC;AAIdkE,MAAAA,WAAW,EAAE/D,IAAI,GAAG,EAJN;AAKdgE,MAAAA,YAAY,EAAEhE,IAAI,GAAG;AALP,KAAlB;AAQA,wBACI,oBAAC,QAAD,CAAU,IAAV;AAAe,MAAA,GAAG,EAAE4C,KAApB;AAA2B,MAAA,KAAK,EAAE,CAACV,WAAD;AAAlC,oBACI,oBAAC,QAAD,CAAU,IAAV;AAAe,MAAA,KAAK,EAAEmB;AAAtB,oBACI,oBAAC,QAAD,CAAU,IAAV;AACI,MAAA,KAAK,EAAE,CAACf,cAAD,EAAiBqB,WAAjB,CADX;AAEI,MAAA,WAAW,EAAE;AAFjB,oBAII,oBAAC,QAAD,CAAU,IAAV;AAAe,MAAA,KAAK,EAAEF;AAAtB,oBACI,oBAAC,QAAD,CAAU,IAAV;AAAe,MAAA,KAAK,EAAEnB,cAAtB;AAAsC,MAAA,WAAW,EAAE;AAAnD,oBACI,oBAAC,QAAD,CAAU,IAAV;AAAe,MAAA,KAAK,EAAEuB;AAAtB,MADJ,CADJ,CAJJ,CADJ,CADJ,CADJ;AAgBH,GAvEA,CAJL,CALJ,CADJ;AAqFH,CAvLD;;AAyLA,eAAelE,iBAAf","sourcesContent":["import * as React from \"react\";\r\nimport {\r\n    Animated,\r\n    Easing,\r\n    Platform,\r\n    StyleProp,\r\n    StyleSheet,\r\n    View,\r\n    ViewStyle,\r\n} from \"react-native\";\r\nimport { DefaultTheme, ThemeContext } from \"styled-components\";\r\nimport styled from \"styled-components/native\";\r\n\r\nconst ActivityIndicatorContainer = styled.View`\r\n    justify-content: center;\r\n    align-items: center;\r\n`;\r\n\r\ntype Props = React.ComponentPropsWithRef<typeof View> & {\r\n    /**\r\n     * Whether to show the indicator or hide it.\r\n     */\r\n    animating?: boolean;\r\n    /**\r\n     * The color of the spinner.\r\n     */\r\n    color?: string;\r\n    /**\r\n     * Size of the indicator.\r\n     */\r\n    size?: \"small\" | \"large\" | number;\r\n    /**\r\n     * Whether the indicator should hide when not animating.\r\n     */\r\n    hidesWhenStopped?: boolean;\r\n    style?: StyleProp<ViewStyle>;\r\n    /**\r\n     * @optional\r\n     */\r\n    theme?: DefaultTheme;\r\n};\r\n\r\nconst DURATION = 2400;\r\n\r\n/**\r\n * Activity indicator is used to present progress of some activity in the app.\r\n * It can be used as a drop-in for the ActivityIndicator shipped with React Native.\r\n *\r\n * <div class=\"screenshots\">\r\n *   <img src=\"screenshots/activity-indicator.gif\" style=\"width: 100px;\" />\r\n * </div>\r\n *\r\n * ## Usage\r\n * ```js\r\n * import * as React from 'react';\r\n * import ActivityIndicator from \"react-native-simple-elements/components/ActivityIndicator\";\r\n * import * as Colors from 'react-native-simple-elements/components/theme/colors';\r\n *\r\n * const MyComponent = () => (\r\n *     <ActivityIndicator animating={true} color={Colors.red800} />\r\n * );\r\n *\r\n * export default MyComponent;\r\n * ```\r\n */\r\nconst ActivityIndicator = ({\r\n    animating = true,\r\n    color: indicatorColor,\r\n    hidesWhenStopped = true,\r\n    size: indicatorSize = \"small\",\r\n    style,\r\n}: Props) => {\r\n    const theme = React.useContext(ThemeContext);\r\n\r\n    const { current: timer } = React.useRef<Animated.Value>(\r\n        new Animated.Value(0)\r\n    );\r\n    const { current: fade } = React.useRef<Animated.Value>(\r\n        new Animated.Value(!animating && hidesWhenStopped ? 0 : 1)\r\n    );\r\n\r\n    const rotation = React.useRef<Animated.CompositeAnimation | undefined>(\r\n        undefined\r\n    );\r\n\r\n    const {\r\n        animation: { scale },\r\n    } = theme;\r\n\r\n    const startRotation = React.useCallback(() => {\r\n        // Show indicator\r\n        Animated.timing(fade, {\r\n            duration: 200 * scale,\r\n            toValue: 1,\r\n            isInteraction: false,\r\n            useNativeDriver: true,\r\n        }).start();\r\n\r\n        // Circular animation in loop\r\n        if (rotation.current) {\r\n            timer.setValue(0);\r\n            // $FlowFixMe\r\n            Animated.loop(rotation.current).start();\r\n        }\r\n    }, [scale, fade, timer]);\r\n\r\n    const stopRotation = () => {\r\n        if (rotation.current) {\r\n            rotation.current.stop();\r\n        }\r\n    };\r\n\r\n    React.useEffect(() => {\r\n        if (rotation.current === undefined) {\r\n            // Circular animation in loop\r\n            rotation.current = Animated.timing(timer, {\r\n                duration: DURATION,\r\n                easing: Easing.linear,\r\n                // Animated.loop does not work if useNativeDriver is true on web\r\n                useNativeDriver: Platform.OS !== \"web\",\r\n                toValue: 1,\r\n                isInteraction: false,\r\n            });\r\n        }\r\n\r\n        if (animating) {\r\n            startRotation();\r\n        } else if (hidesWhenStopped) {\r\n            // Hide indicator first and then stop rotation\r\n            Animated.timing(fade, {\r\n                duration: 200 * scale,\r\n                toValue: 0,\r\n                useNativeDriver: true,\r\n                isInteraction: false,\r\n            }).start(stopRotation);\r\n        } else {\r\n            stopRotation();\r\n        }\r\n    }, [animating, fade, hidesWhenStopped, startRotation, scale, timer]);\r\n\r\n    const color = indicatorColor || theme.colors.primary;\r\n    const size =\r\n        typeof indicatorSize === \"string\"\r\n            ? indicatorSize === \"small\"\r\n                ? 24\r\n                : 48\r\n            : indicatorSize\r\n                ? indicatorSize\r\n                : 24;\r\n\r\n    const frames = (60 * DURATION) / 1000;\r\n    const easing = Easing.bezier(0.4, 0.0, 0.7, 1.0);\r\n    const layerStyle0 = {\r\n        ...StyleSheet.absoluteFillObject,\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n    } as any;\r\n    const containerStyle = {\r\n        width: size,\r\n        height: size / 2,\r\n        overflow: \"hidden\",\r\n    } as any;\r\n\r\n    return (\r\n        <ActivityIndicatorContainer\r\n            accessible\r\n            accessibilityRole=\"progressbar\"\r\n            style={style}\r\n        >\r\n            <Animated.View\r\n                style={[{ width: size, height: size, opacity: fade }]}\r\n                collapsable={false}\r\n            >\r\n                {[0, 1].map((index) => {\r\n                    // Thanks to https://github.com/n4kz/react-native-indicators for the great work\r\n                    const inputRange = Array.from(\r\n                        new Array(frames),\r\n                        (_, frameIndex) => frameIndex / (frames - 1)\r\n                    );\r\n                    const outputRange = Array.from(new Array(frames), (_, frameIndex) => {\r\n                        let progress = (2 * frameIndex) / (frames - 1);\r\n                        const rotation = index ? +(360 - 15) : -(180 - 15);\r\n\r\n                        if (progress > 1.0) {\r\n                            progress = 2.0 - progress;\r\n                        }\r\n\r\n                        const direction = index ? -1 : +1;\r\n\r\n                        return `${direction * (180 - 30) * easing(progress) + rotation}deg`;\r\n                    });\r\n\r\n                    const layerStyle = {\r\n                        width: size,\r\n                        height: size,\r\n                        transform: [\r\n                            {\r\n                                rotate: timer.interpolate({\r\n                                    inputRange: [0, 1],\r\n                                    outputRange: [`${0 + 30 + 15}deg`, `${2 * 360 + 30 + 15}deg`],\r\n                                }),\r\n                            },\r\n                        ],\r\n                    };\r\n\r\n                    const viewportStyle = {\r\n                        width: size,\r\n                        height: size,\r\n                        transform: [\r\n                            {\r\n                                translateY: index ? -size / 2 : 0,\r\n                            },\r\n                            {\r\n                                rotate: timer.interpolate({ inputRange, outputRange }),\r\n                            },\r\n                        ],\r\n                    };\r\n\r\n                    const offsetStyle = index ? { top: size / 2 } : null;\r\n\r\n                    const lineStyle = {\r\n                        width: size,\r\n                        height: size,\r\n                        borderColor: color,\r\n                        borderWidth: size / 10,\r\n                        borderRadius: size / 2,\r\n                    };\r\n\r\n                    return (\r\n                        <Animated.View key={index} style={[layerStyle0]}>\r\n                            <Animated.View style={layerStyle}>\r\n                                <Animated.View\r\n                                    style={[containerStyle, offsetStyle]}\r\n                                    collapsable={false}\r\n                                >\r\n                                    <Animated.View style={viewportStyle}>\r\n                                        <Animated.View style={containerStyle} collapsable={false}>\r\n                                            <Animated.View style={lineStyle} />\r\n                                        </Animated.View>\r\n                                    </Animated.View>\r\n                                </Animated.View>\r\n                            </Animated.View>\r\n                        </Animated.View>\r\n                    );\r\n                })}\r\n            </Animated.View>\r\n        </ActivityIndicatorContainer>\r\n    );\r\n};\r\n\r\nexport default ActivityIndicator;\r\n"]}