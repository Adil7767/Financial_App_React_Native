{"version":3,"sources":["Carousel.tsx"],"names":["React","Animated","Easing","FlatList","I18nManager","Platform","ScrollView","View","ViewPropTypes","defaultScrollInterpolator","stackScrollInterpolator","tinderScrollInterpolator","defaultAnimatedStyles","shiftAnimatedStyles","stackAnimatedStyles","tinderAnimatedStyles","IS_IOS","OS","AnimatedFlatList","createAnimatedComponent","AnimatedScrollView","IS_RTL","isRTL","Carousel","PureComponent","constructor","props","hideCarousel","interpolators","enableMomentum","itemWidth","itemHeight","loopClonesPerSide","sliderWidth","sliderHeight","vertical","visibleItems","Math","ceil","initialNumPerSide","_enableLoop","initialNumToRender","maxToRenderPerBatch","windowSize","specificProps","_needsScrollView","decelerationRate","showsHorizontalScrollIndicator","showsVerticalScrollIndicator","overScrollMode","automaticallyAdjustContentInsets","directionalLockEnabled","pinchGestureEnabled","scrollsToTop","removeClippedSubviews","inverted","_needsRTLAdaptations","initialActiveItem","_getFirstItem","firstItem","_activeItem","_previousActiveItem","_previousFirstItem","_previousItemsLength","_mounted","_positions","_currentContentOffset","_canFireBeforeCallback","_canFireCallback","_scrollOffsetRef","_onScrollTriggered","_lastScrollDate","_scrollEnabled","scrollEnabled","_ignoreNextMomentum","_initPositionsAndInterpolators","bind","_renderItem","_onSnap","_onLayout","_onScroll","_onScrollBeginDrag","enableSnap","undefined","_onScrollEnd","autoplay","_onScrollEndDrag","_onMomentumScrollEnd","_onTouchStart","_onTouchEnd","_onTouchRelease","_getKeyExtractor","_setScrollHandler","console","warn","error","apparitionDelay","useScrollView","customAnimationType","customAnimationOptions","onScrollViewScroll","componentDidMount","_firstItem","apparitionCallback","setState","startAutoplay","requestAnimationFrame","_snapToItem","_hackActiveSlideAnimation","_apparitionTimeout","setTimeout","componentDidUpdate","prevProps","state","itemsLength","_getCustomDataLength","nextFirstItem","nextActiveItem","hasNewSliderWidth","hasNewSliderHeight","hasNewItemWidth","hasNewItemHeight","hasNewScrollEnabled","_setScrollEnabled","length","onScroll","componentWillUnmount","stopAutoplay","clearTimeout","_hackSlideAnimationTimeout","_enableAutoplayTimeout","_autoplayTimeout","_snapNoMomentumTimeout","_edgeItemTimeout","_lockScrollTimeout","realIndex","currentIndex","_getDataIndex","currentScrollPosition","scrollEventConfig","listener","useNativeDriver","_scrollPos","Value","argMapping","nativeEvent","contentOffset","y","x","Array","isArray","_argMapping","pop","argMap","push","_onScrollHandler","event","_shouldUseStackLayout","_shouldUseTinderLayout","_canLockScroll","lockScrollWhileSnapping","data","loop","_shouldAnimateSlides","inactiveSlideOpacity","inactiveSlideScale","scrollInterpolator","slideInterpolatedStyle","_shouldUseShiftLayout","_shouldUseCustomAnimation","activeAnimationOptions","inactiveSlideShift","layout","_getCustomData","dataLength","previousItems","nextItems","dataMultiplier","floor","remainder","i","unshift","slice","concat","_getCustomIndex","index","baseDataIndexes","dataIndexes","j","_getPositionIndex","_getWrappedRef","_carouselRef","scrollTo","scrollToOffset","getNode","_getScrollEnabled","wrappedRef","setNativeProps","item","_getScrollOffset","_getContainerInnerMargin","opposite","activeSlideAlignment","_getViewportOffset","_getCenter","offset","_getActiveItem","activeSlideOffset","swipeThreshold","center","centerOffset","start","end","lastIndex","sizeRef","forEach","itemData","_index","animatedValue","interpolator","inputRange","outputRange","interpolate","extrapolate","_getSlideAnimation","toValue","activeAnimationType","animationCommonOptions","isInteraction","parallel","easing","linear","_playCustomSlideAnimation","current","next","_currentIndex","_currentDataIndex","_nextIndex","_nextDataIndex","animations","stopTogether","goTo","force","direction","_scrollTo","_lockScroll","lockScrollTimeoutDuration","_releaseScroll","_repositionScroll","repositionTo","animated","specificOptions","options","callbackOffsetMargin","scrollOffset","itemReached","_itemToSnapTo","scrollConditions","Date","now","_onBeforeSnap","_onStartShouldSetResponderCapture","onStartShouldSetResponderCapture","onTouchStart","_autoplaying","pauseAutoPlay","onTouchEnd","_autoplay","onScrollBeginDrag","_scrollStartOffset","_scrollStartActive","onScrollEndDrag","onMomentumScrollEnd","autoplayDelay","_scrollEndOffset","_scrollEndActive","_snapScroll","onLayout","_onLayoutInitDone","delta","fireCallback","initial","lockScroll","onSnapToItem","onBeforeSnapToItem","autoplayInterval","_autoplayInterval","setInterval","snapToNext","clearInterval","snapToItem","positionIndex","newIndex","snapToPrev","triggerRenderingHack","scrollPosition","_getSlideInterpolatedStyle","layoutCardOffset","hasParallaxImages","keyExtractor","renderItem","slideStyle","animate","Component","animatedStyle","parallaxProps","carouselRef","mainDimension","height","width","key","_getComponentStaticProps","containerCustomStyle","contentContainerCustomStyle","style","containerStyle","opacity","flexDirection","contentContainerStyle","paddingTop","paddingBottom","paddingLeft","paddingRight","numColumns","ref","c","horizontal","scrollEventThrottle","onResponderRelease","render","_getComponentOverridableProps","ScrollViewComponent","map"],"mappings":"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","sourcesContent":["import * as React from \"react\";\nimport {\n    Animated,\n    Easing,\n    FlatList,\n    I18nManager,\n    Platform,\n    ScrollView,\n    StyleProp,\n    View,\n    ViewPropTypes,\n    ViewStyle,\n} from \"react-native\";\nimport {\n    defaultScrollInterpolator,\n    stackScrollInterpolator,\n    tinderScrollInterpolator,\n    defaultAnimatedStyles,\n    shiftAnimatedStyles,\n    stackAnimatedStyles,\n    tinderAnimatedStyles,\n} from \"../utils/animations\";\n\nconst IS_IOS = Platform.OS === \"ios\";\n\n// Native driver for scroll events\n// See: https://facebook.github.io/react-native/blog/2017/02/14/using-native-driver-for-animated.html\nconst AnimatedFlatList = FlatList\n    ? Animated.createAnimatedComponent(FlatList)\n    : null;\nconst AnimatedScrollView = Animated.createAnimatedComponent(ScrollView);\n\n// React Native automatically handles RTL layouts; unfortunately, it's buggy with horizontal ScrollView\n// See https://github.com/facebook/react-native/issues/11960\n// NOTE: the following variable is not declared in the constructor\n// otherwise it is undefined at init, which messes with custom indexes\nconst IS_RTL = I18nManager.isRTL;\n\ntype Props = {\n    data: any[],\n    renderItem: (data, props) => React.ReactNode,\n    itemWidth?: number, // required for horizontal carousel\n    itemHeight?: number, // required for vertical carousel\n    sliderWidth?: number, // required for horizontal carousel\n    sliderHeight?: number, // required for vertical carousel\n    activeAnimationType?: string,\n    activeAnimationOptions?: Record<string, unknown>,\n    activeSlideAlignment?: \"center\" | \"end\" | \"start\",\n    activeSlideOffset?: number,\n    apparitionDelay?: number,\n    autoplay?: boolean,\n    autoplayDelay?: number,\n    autoplayInterval?: number,\n    callbackOffsetMargin?: number,\n    containerCustomStyle?: StyleProp<ViewStyle>,\n    contentContainerCustomStyle?: StyleProp<ViewStyle>,\n    enableMomentum?: boolean,\n    enableSnap?: boolean,\n    firstItem?: number,\n    hasParallaxImages?: boolean,\n    inactiveSlideOpacity?: number,\n    inactiveSlideScale?: number,\n    inactiveSlideShift?: number,\n    layout?: \"default\" | \"stack\" | \"tinder\",\n    layoutCardOffset?: number,\n    lockScrollTimeoutDuration?: number,\n    lockScrollWhileSnapping?: boolean,\n    loop?: boolean,\n    loopClonesPerSide?: number,\n    scrollEnabled?: boolean,\n    scrollInterpolator?: (index, props) => void,\n    slideInterpolatedStyle?: (index, animatedValue, props) => void,\n    slideStyle?: StyleProp<ViewStyle>,\n    swipeThreshold?: number,\n    useScrollView?: boolean | (() => void),\n    vertical?: boolean,\n    onBeforeSnapToItem?: (index) => void,\n    onSnapToItem?: (index?) => void,\n    onScroll?: (evt) => void,\n    keyExtractor?: string | (() => void),\n    onTouchStart?: (evt?) => void,\n    onTouchEnd?: (evt?) => void,\n    onScrollBeginDrag?: (evt) => void,\n    onScrollEndDrag?: (evt) => void,\n    style?: Record<string, unknown>,\n    customAnimationType?: string,\n    customAnimationOptions?: Record<string, unknown>,\n    onScrollViewScroll?: (evt) => void,\n    onStartShouldSetResponderCapture?: (evt) => void,\n    onMomentumScrollEnd?: (evt?) => void,\n    onLayout?: (evt?) => void,\n};\n\ntype State = {\n    hideCarousel: boolean,\n    interpolators: any[],\n}\n\nexport default class Carousel extends React.PureComponent<Props, State> {\n\n    static defaultProps = {\n        activeAnimationType: \"timing\",\n        activeAnimationOptions: null,\n        activeSlideAlignment: \"center\",\n        activeSlideOffset: 20,\n        apparitionDelay: 0,\n        autoplay: false,\n        autoplayDelay: 1000,\n        autoplayInterval: 3000,\n        callbackOffsetMargin: 5,\n        containerCustomStyle: {},\n        contentContainerCustomStyle: {},\n        enableMomentum: false,\n        enableSnap: true,\n        firstItem: 0,\n        hasParallaxImages: false,\n        inactiveSlideOpacity: 0.7,\n        inactiveSlideScale: 0.9,\n        inactiveSlideShift: 0,\n        layout: \"default\",\n        lockScrollTimeoutDuration: 1000,\n        lockScrollWhileSnapping: false,\n        loop: false,\n        loopClonesPerSide: 3,\n        scrollEnabled: true,\n        slideStyle: {},\n        swipeThreshold: 20,\n        useScrollView: !AnimatedFlatList,\n        vertical: false,\n    };\n\n    state: State = {\n        hideCarousel: true,\n        interpolators: [],\n    };\n\n    _activeItem: number;\n    _previousActiveItem: number;\n    _previousFirstItem: number;\n    _previousItemsLength: number;\n\n    _mounted: boolean;\n    _positions: any[];\n    _currentContentOffset: number; // store ScrollView's scroll position\n    _canFireBeforeCallback: boolean;\n    _canFireCallback: boolean;\n    _scrollOffsetRef = null;\n    _onScrollTriggered = true; // used when momentum is enabled to prevent an issue with edges items\n    _lastScrollDate: number; // used to work around a FlatList bug\n    _scrollEnabled: boolean;\n\n    // This bool aims at fixing an iOS bug due to scrollTo that triggers onMomentumScrollEnd.\n    // onMomentumScrollEnd fires this._snapScroll, thus creating an infinite loop.\n    _ignoreNextMomentum: boolean;\n\n    _carouselRef;\n\n    _scrollPos: Animated.Value;\n\n    _onScrollHandler;\n\n    _apparitionTimeout;\n    _hackSlideAnimationTimeout;\n    _enableAutoplayTimeout;\n    _autoplayTimeout;\n    _snapNoMomentumTimeout;\n    _edgeItemTimeout;\n    _lockScrollTimeout;\n\n    _autoplayInterval;\n\n    _itemToSnapTo: number;\n\n    _autoplay: boolean;\n    _autoplaying: boolean;\n\n    _scrollStartOffset: number;\n    _scrollStartActive: number;\n    _scrollEndOffset: number;\n    _scrollEndActive: number;\n\n    _onLayoutInitDone: boolean;\n\n    constructor(props) {\n        super(props);\n\n        // The following values are not stored in the state because 'setState()' is asynchronous\n        // and this results in an absolutely crappy behavior on Android while swiping (see #156)\n        const initialActiveItem = this._getFirstItem(props.firstItem);\n        this._activeItem = initialActiveItem;\n        this._previousActiveItem = initialActiveItem;\n        this._previousFirstItem = initialActiveItem;\n        this._previousItemsLength = initialActiveItem;\n\n        this._mounted = false;\n        this._positions = [];\n        this._currentContentOffset = 0; // store ScrollView's scroll position\n        this._canFireBeforeCallback = false;\n        this._canFireCallback = false;\n        this._scrollOffsetRef = null;\n        this._onScrollTriggered = true; // used when momentum is enabled to prevent an issue with edges items\n        this._lastScrollDate = 0; // used to work around a FlatList bug\n        this._scrollEnabled = props.scrollEnabled !== false;\n\n        // This bool aims at fixing an iOS bug due to scrollTo that triggers onMomentumScrollEnd.\n        // onMomentumScrollEnd fires this._snapScroll, thus creating an infinite loop.\n        this._ignoreNextMomentum = false;\n\n        this._initPositionsAndInterpolators = this._initPositionsAndInterpolators.bind(\n            this\n        );\n        this._renderItem = this._renderItem.bind(this);\n        this._onSnap = this._onSnap.bind(this);\n\n        this._onLayout = this._onLayout.bind(this);\n        this._onScroll = this._onScroll.bind(this);\n        this._onScrollBeginDrag = props.enableSnap\n            ? this._onScrollBeginDrag.bind(this)\n            : undefined;\n        this._onScrollEnd =\n            props.enableSnap || props.autoplay\n                ? this._onScrollEnd.bind(this)\n                : undefined;\n        this._onScrollEndDrag = !props.enableMomentum\n            ? this._onScrollEndDrag.bind(this)\n            : undefined;\n        this._onMomentumScrollEnd = props.enableMomentum\n            ? this._onMomentumScrollEnd.bind(this)\n            : undefined;\n        this._onTouchStart = this._onTouchStart.bind(this);\n        this._onTouchEnd = this._onTouchEnd.bind(this);\n        this._onTouchRelease = this._onTouchRelease.bind(this);\n\n        this._getKeyExtractor = this._getKeyExtractor.bind(this);\n\n        this._setScrollHandler(props);\n\n        // Warnings\n        if (!ViewPropTypes) {\n            console.warn(\n                \"react-native-snap-carousel: It is recommended to use at least version 0.44 of React Native with the plugin\"\n            );\n        }\n        if (!props.vertical && (!props.sliderWidth || !props.itemWidth)) {\n            console.error(\n                \"react-native-snap-carousel: You need to specify both `sliderWidth` and `itemWidth` for horizontal carousels\"\n            );\n        }\n        if (props.vertical && (!props.sliderHeight || !props.itemHeight)) {\n            console.error(\n                \"react-native-snap-carousel: You need to specify both `sliderHeight` and `itemHeight` for vertical carousels\"\n            );\n        }\n        if (props.apparitionDelay && !IS_IOS && !props.useScrollView) {\n            console.warn(\n                \"react-native-snap-carousel: Using `apparitionDelay` on Android is not recommended since it can lead to rendering issues\"\n            );\n        }\n        if (props.customAnimationType || props.customAnimationOptions) {\n            console.warn(\n                \"react-native-snap-carousel: Props `customAnimationType` and `customAnimationOptions` have been renamed to `activeAnimationType` and `activeAnimationOptions`\"\n            );\n        }\n        if (props.onScrollViewScroll) {\n            console.error(\n                \"react-native-snap-carousel: Prop `onScrollViewScroll` has been removed. Use `onScroll` instead\"\n            );\n        }\n    }\n\n    componentDidMount() {\n        const { apparitionDelay, autoplay, firstItem } = this.props;\n        const _firstItem = this._getFirstItem(firstItem);\n        const apparitionCallback = () => {\n            this.setState({ hideCarousel: false });\n            if (autoplay) {\n                this.startAutoplay();\n            }\n        };\n\n        this._mounted = true;\n        this._initPositionsAndInterpolators();\n\n        // Without 'requestAnimationFrame' or a `0` timeout, images will randomly not be rendered on Android...\n        requestAnimationFrame(() => {\n            if (!this._mounted) {\n                return;\n            }\n\n            this._snapToItem(_firstItem, false, false, true, false);\n            this._hackActiveSlideAnimation(_firstItem, \"start\", true);\n\n            if (apparitionDelay) {\n                this._apparitionTimeout = setTimeout(() => {\n                    apparitionCallback();\n                }, apparitionDelay);\n            } else {\n                apparitionCallback();\n            }\n        });\n    }\n\n    componentDidUpdate(prevProps) {\n        const { interpolators } = this.state;\n        const {\n            firstItem,\n            itemHeight,\n            itemWidth,\n            scrollEnabled,\n            sliderHeight,\n            sliderWidth,\n        } = this.props;\n        const itemsLength = this._getCustomDataLength(this.props);\n\n        if (!itemsLength) {\n            return;\n        }\n\n        const nextFirstItem = this._getFirstItem(firstItem, this.props);\n        let nextActiveItem =\n            this._activeItem || this._activeItem === 0\n                ? this._activeItem\n                : nextFirstItem;\n\n        const hasNewSliderWidth =\n            sliderWidth && sliderWidth !== prevProps.sliderWidth;\n        const hasNewSliderHeight =\n            sliderHeight && sliderHeight !== prevProps.sliderHeight;\n        const hasNewItemWidth = itemWidth && itemWidth !== prevProps.itemWidth;\n        const hasNewItemHeight = itemHeight && itemHeight !== prevProps.itemHeight;\n        const hasNewScrollEnabled = scrollEnabled !== prevProps.scrollEnabled;\n\n        // Prevent issues with dynamically removed items\n        if (nextActiveItem > itemsLength - 1) {\n            nextActiveItem = itemsLength - 1;\n        }\n\n        // Handle changing scrollEnabled independent of user -> carousel interaction\n        if (hasNewScrollEnabled) {\n            this._setScrollEnabled(scrollEnabled);\n        }\n\n        if (\n            interpolators.length !== itemsLength ||\n            hasNewSliderWidth ||\n            hasNewSliderHeight ||\n            hasNewItemWidth ||\n            hasNewItemHeight\n        ) {\n            this._activeItem = nextActiveItem;\n            this._previousItemsLength = itemsLength;\n\n            this._initPositionsAndInterpolators(this.props);\n\n            // Handle scroll issue when dynamically removing items (see #133)\n            // This also fixes first item's active state on Android\n            // Because 'initialScrollIndex' apparently doesn't trigger scroll\n            if (this._previousItemsLength > itemsLength) {\n                this._hackActiveSlideAnimation(nextActiveItem, null, true);\n            }\n\n            if (\n                hasNewSliderWidth ||\n                hasNewSliderHeight ||\n                hasNewItemWidth ||\n                hasNewItemHeight\n            ) {\n                this._snapToItem(nextActiveItem, false, false, false, false);\n            }\n        } else if (\n            nextFirstItem !== this._previousFirstItem &&\n            nextFirstItem !== this._activeItem\n        ) {\n            this._activeItem = nextFirstItem;\n            this._previousFirstItem = nextFirstItem;\n            this._snapToItem(nextFirstItem, false, true, false, false);\n        }\n\n        if (this.props.onScroll !== prevProps.onScroll) {\n            this._setScrollHandler(this.props);\n        }\n    }\n\n    componentWillUnmount() {\n        this._mounted = false;\n        this.stopAutoplay();\n        clearTimeout(this._apparitionTimeout);\n        clearTimeout(this._hackSlideAnimationTimeout);\n        clearTimeout(this._enableAutoplayTimeout);\n        clearTimeout(this._autoplayTimeout);\n        clearTimeout(this._snapNoMomentumTimeout);\n        clearTimeout(this._edgeItemTimeout);\n        clearTimeout(this._lockScrollTimeout);\n    }\n\n    get realIndex() {\n        return this._activeItem;\n    }\n\n    get currentIndex() {\n        return this._getDataIndex(this._activeItem);\n    }\n\n    get currentScrollPosition() {\n        return this._currentContentOffset;\n    }\n\n    _setScrollHandler(props) {\n        // Native driver for scroll events\n        const scrollEventConfig = {\n            listener: this._onScroll,\n            useNativeDriver: true,\n        };\n        this._scrollPos = new Animated.Value(0);\n        const argMapping = props.vertical\n            ? [{ nativeEvent: { contentOffset: { y: this._scrollPos } } }]\n            : [{ nativeEvent: { contentOffset: { x: this._scrollPos } } }];\n\n        if (props.onScroll && Array.isArray(props.onScroll._argMapping)) {\n            // Because of a react-native issue https://github.com/facebook/react-native/issues/13294\n            argMapping.pop();\n            const [argMap] = props.onScroll._argMapping;\n            if (argMap && argMap.nativeEvent && argMap.nativeEvent.contentOffset) {\n                // Shares the same animated value passed in props\n                this._scrollPos =\n                    argMap.nativeEvent.contentOffset.x ||\n                    argMap.nativeEvent.contentOffset.y ||\n                    this._scrollPos;\n            }\n            argMapping.push(...props.onScroll._argMapping);\n        }\n        this._onScrollHandler = Animated.event(argMapping, scrollEventConfig);\n    }\n\n    _needsScrollView() {\n        const { useScrollView } = this.props;\n        return (\n            useScrollView ||\n            !AnimatedFlatList ||\n            this._shouldUseStackLayout() ||\n            this._shouldUseTinderLayout()\n        );\n    }\n\n    _needsRTLAdaptations() {\n        const { vertical } = this.props;\n        return IS_RTL && !IS_IOS && !vertical;\n    }\n\n    _canLockScroll() {\n        const {\n            scrollEnabled,\n            enableMomentum,\n            lockScrollWhileSnapping,\n        } = this.props;\n        return scrollEnabled && !enableMomentum && lockScrollWhileSnapping;\n    }\n\n    _enableLoop() {\n        const { data, enableSnap, loop } = this.props;\n        return enableSnap && loop && data && data.length && data.length > 1;\n    }\n\n    _shouldAnimateSlides(props = this.props) {\n        const {\n            inactiveSlideOpacity,\n            inactiveSlideScale,\n            scrollInterpolator,\n            slideInterpolatedStyle,\n        } = props;\n        return (\n            inactiveSlideOpacity < 1 ||\n            inactiveSlideScale < 1 ||\n            !!scrollInterpolator ||\n            !!slideInterpolatedStyle ||\n            this._shouldUseShiftLayout() ||\n            this._shouldUseStackLayout() ||\n            this._shouldUseTinderLayout()\n        );\n    }\n\n    _shouldUseCustomAnimation() {\n        const { activeAnimationOptions } = this.props;\n        return (\n            !!activeAnimationOptions &&\n            !this._shouldUseStackLayout() &&\n            !this._shouldUseTinderLayout()\n        );\n    }\n\n    _shouldUseShiftLayout() {\n        const { inactiveSlideShift, layout } = this.props;\n        return layout === \"default\" && inactiveSlideShift !== 0;\n    }\n\n    _shouldUseStackLayout() {\n        return this.props.layout === \"stack\";\n    }\n\n    _shouldUseTinderLayout() {\n        return this.props.layout === \"tinder\";\n    }\n\n    _getCustomData(props = this.props) {\n        const { data, loopClonesPerSide } = props;\n        const dataLength = data && data.length;\n\n        if (!dataLength) {\n            return [];\n        }\n\n        if (!this._enableLoop()) {\n            return data;\n        }\n\n        let previousItems = [];\n        let nextItems = [];\n\n        if (loopClonesPerSide > dataLength) {\n            const dataMultiplier = Math.floor(loopClonesPerSide / dataLength);\n            const remainder = loopClonesPerSide % dataLength;\n\n            for (let i = 0; i < dataMultiplier; i++) {\n                previousItems.push(...data);\n                nextItems.push(...data);\n            }\n\n            previousItems.unshift(...data.slice(-remainder));\n            nextItems.push(...data.slice(0, remainder));\n        } else {\n            previousItems = data.slice(-loopClonesPerSide);\n            nextItems = data.slice(0, loopClonesPerSide);\n        }\n\n        return previousItems.concat(data, nextItems);\n    }\n\n    _getCustomDataLength(props = this.props) {\n        const { data, loopClonesPerSide } = props;\n        const dataLength = data && data.length;\n\n        if (!dataLength) {\n            return 0;\n        }\n\n        return this._enableLoop() ? dataLength + 2 * loopClonesPerSide : dataLength;\n    }\n\n    _getCustomIndex(index, props = this.props) {\n        const itemsLength = this._getCustomDataLength(props);\n\n        if (!itemsLength || (!index && index !== 0)) {\n            return 0;\n        }\n\n        return this._needsRTLAdaptations() ? itemsLength - index - 1 : index;\n    }\n\n    _getDataIndex(index) {\n        const { data, loopClonesPerSide } = this.props;\n        const dataLength = data && data.length;\n\n        if (!this._enableLoop() || !dataLength) {\n            return index;\n        }\n\n        if (index >= dataLength + loopClonesPerSide) {\n            return loopClonesPerSide > dataLength\n                ? (index - loopClonesPerSide) % dataLength\n                : index - dataLength - loopClonesPerSide;\n        } else if (index < loopClonesPerSide) {\n            // TODO: is there a simpler way of determining the interpolated index?\n            if (loopClonesPerSide > dataLength) {\n                const baseDataIndexes = [];\n                const dataIndexes = [];\n                const dataMultiplier = Math.floor(loopClonesPerSide / dataLength);\n                const remainder = loopClonesPerSide % dataLength;\n\n                for (let i = 0; i < dataLength; i++) {\n                    baseDataIndexes.push(i);\n                }\n\n                for (let j = 0; j < dataMultiplier; j++) {\n                    dataIndexes.push(...baseDataIndexes);\n                }\n\n                dataIndexes.unshift(...baseDataIndexes.slice(-remainder));\n                return dataIndexes[index];\n            } else {\n                return index + dataLength - loopClonesPerSide;\n            }\n        } else {\n            return index - loopClonesPerSide;\n        }\n    }\n\n    // Used with `snapToItem()` and 'PaginationDot'\n    _getPositionIndex(index) {\n        const { loop, loopClonesPerSide } = this.props;\n        return loop ? index + loopClonesPerSide : index;\n    }\n\n    _getFirstItem(index, props = this.props) {\n        const { loopClonesPerSide } = props;\n        const itemsLength = this._getCustomDataLength(props);\n\n        if (!itemsLength || index > itemsLength - 1 || index < 0) {\n            return 0;\n        }\n\n        return this._enableLoop() ? index + loopClonesPerSide : index;\n    }\n\n    _getWrappedRef() {\n        if (\n            this._carouselRef &&\n            ((this._needsScrollView() && this._carouselRef.scrollTo) ||\n                (!this._needsScrollView() && this._carouselRef.scrollToOffset))\n        ) {\n            return this._carouselRef;\n        }\n        // https://github.com/facebook/react-native/issues/10635\n        // https://stackoverflow.com/a/48786374/8412141\n        return (\n            this._carouselRef &&\n            this._carouselRef.getNode &&\n            this._carouselRef.getNode()\n        );\n    }\n\n    _getScrollEnabled() {\n        return this._scrollEnabled;\n    }\n\n    _setScrollEnabled(scrollEnabled = true) {\n        const wrappedRef = this._getWrappedRef();\n\n        if (!wrappedRef || !wrappedRef.setNativeProps) {\n            return;\n        }\n\n        // 'setNativeProps()' is used instead of 'setState()' because the latter\n        // really takes a toll on Android behavior when momentum is disabled\n        wrappedRef.setNativeProps({ scrollEnabled });\n        this._scrollEnabled = scrollEnabled;\n    }\n\n    _getKeyExtractor(item, index) {\n        return this._needsScrollView()\n            ? `scrollview-item-${index}`\n            : `flatlist-item-${index}`;\n    }\n\n    _getScrollOffset(event) {\n        const { vertical } = this.props;\n        return (\n            (event &&\n                event.nativeEvent &&\n                event.nativeEvent.contentOffset &&\n                event.nativeEvent.contentOffset[vertical ? \"y\" : \"x\"]) ||\n            0\n        );\n    }\n\n    _getContainerInnerMargin(opposite = false) {\n        const {\n            sliderWidth,\n            sliderHeight,\n            itemWidth,\n            itemHeight,\n            vertical,\n            activeSlideAlignment,\n        } = this.props;\n\n        if (\n            (activeSlideAlignment === \"start\" && !opposite) ||\n            (activeSlideAlignment === \"end\" && opposite)\n        ) {\n            return 0;\n        } else if (\n            (activeSlideAlignment === \"end\" && !opposite) ||\n            (activeSlideAlignment === \"start\" && opposite)\n        ) {\n            return vertical ? sliderHeight - itemHeight : sliderWidth - itemWidth;\n        } else {\n            return vertical\n                ? (sliderHeight - itemHeight) / 2\n                : (sliderWidth - itemWidth) / 2;\n        }\n    }\n\n    _getViewportOffset() {\n        const {\n            sliderWidth,\n            sliderHeight,\n            itemWidth,\n            itemHeight,\n            vertical,\n            activeSlideAlignment,\n        } = this.props;\n\n        if (activeSlideAlignment === \"start\") {\n            return vertical ? itemHeight / 2 : itemWidth / 2;\n        } else if (activeSlideAlignment === \"end\") {\n            return vertical\n                ? sliderHeight - itemHeight / 2\n                : sliderWidth - itemWidth / 2;\n        } else {\n            return vertical ? sliderHeight / 2 : sliderWidth / 2;\n        }\n    }\n\n    _getCenter(offset) {\n        return offset + this._getViewportOffset() - this._getContainerInnerMargin();\n    }\n\n    _getActiveItem(offset) {\n        const { activeSlideOffset, swipeThreshold } = this.props;\n        const center = this._getCenter(offset);\n        const centerOffset = activeSlideOffset || swipeThreshold;\n\n        for (let i = 0; i < this._positions.length; i++) {\n            const { start, end } = this._positions[i];\n            if (center + centerOffset >= start && center - centerOffset <= end) {\n                return i;\n            }\n        }\n\n        const lastIndex = this._positions.length - 1;\n        if (\n            this._positions[lastIndex] &&\n            center - centerOffset > this._positions[lastIndex].end\n        ) {\n            return lastIndex;\n        }\n\n        return 0;\n    }\n\n    _initPositionsAndInterpolators(props = this.props) {\n        const { data, itemWidth, itemHeight, scrollInterpolator, vertical } = props;\n        const sizeRef = vertical ? itemHeight : itemWidth;\n\n        if (!data || !data.length) {\n            return;\n        }\n\n        const interpolators = [];\n        this._positions = [];\n\n        this._getCustomData(props).forEach((itemData, index) => {\n            const _index = this._getCustomIndex(index, props);\n            let animatedValue;\n\n            this._positions[index] = {\n                start: index * sizeRef,\n                end: index * sizeRef + sizeRef,\n            };\n\n            if (!this._shouldAnimateSlides(props)) {\n                animatedValue = new Animated.Value(1);\n            } else if (this._shouldUseCustomAnimation()) {\n                animatedValue = new Animated.Value(_index === this._activeItem ? 1 : 0);\n            } else {\n                let interpolator;\n\n                if (scrollInterpolator) {\n                    interpolator = scrollInterpolator(_index, props);\n                } else if (this._shouldUseStackLayout()) {\n                    interpolator = stackScrollInterpolator(_index, props);\n                } else if (this._shouldUseTinderLayout()) {\n                    interpolator = tinderScrollInterpolator(_index, props);\n                }\n\n                if (\n                    !interpolator ||\n                    !interpolator.inputRange ||\n                    !interpolator.outputRange\n                ) {\n                    interpolator = defaultScrollInterpolator(_index, props);\n                }\n\n                animatedValue = this._scrollPos.interpolate({\n                    ...interpolator,\n                    extrapolate: \"clamp\",\n                });\n            }\n\n            interpolators.push(animatedValue);\n        });\n\n        this.setState({ interpolators });\n    }\n\n    _getSlideAnimation(index, toValue) {\n        const { interpolators } = this.state;\n        const { activeAnimationType, activeAnimationOptions } = this.props;\n\n        const animatedValue = interpolators && interpolators[index];\n\n        if (!animatedValue && animatedValue !== 0) {\n            return null;\n        }\n\n        const animationCommonOptions = {\n            isInteraction: false,\n            useNativeDriver: true,\n            ...activeAnimationOptions,\n            toValue: toValue,\n        };\n\n        return Animated.parallel([\n            Animated[\"timing\"](animatedValue, {\n                ...animationCommonOptions,\n                easing: Easing.linear,\n            }),\n            Animated[activeAnimationType](animatedValue, {\n                ...animationCommonOptions,\n            }),\n        ]);\n    }\n\n    _playCustomSlideAnimation(current, next) {\n        const { interpolators } = this.state;\n        const itemsLength = this._getCustomDataLength();\n        const _currentIndex = this._getCustomIndex(current);\n        const _currentDataIndex = this._getDataIndex(_currentIndex);\n        const _nextIndex = this._getCustomIndex(next);\n        const _nextDataIndex = this._getDataIndex(_nextIndex);\n        const animations = [];\n\n        // Keep animations in sync when looping\n        if (this._enableLoop()) {\n            for (let i = 0; i < itemsLength; i++) {\n                if (this._getDataIndex(i) === _currentDataIndex && interpolators[i]) {\n                    animations.push(this._getSlideAnimation(i, 0));\n                } else if (\n                    this._getDataIndex(i) === _nextDataIndex &&\n                    interpolators[i]\n                ) {\n                    animations.push(this._getSlideAnimation(i, 1));\n                }\n            }\n        } else {\n            if (interpolators[current]) {\n                animations.push(this._getSlideAnimation(current, 0));\n            }\n            if (interpolators[next]) {\n                animations.push(this._getSlideAnimation(next, 1));\n            }\n        }\n\n        Animated.parallel(animations, { stopTogether: false }).start();\n    }\n\n    _hackActiveSlideAnimation(index, goTo, force = false) {\n        const { data } = this.props;\n\n        if (\n            !this._mounted ||\n            !this._carouselRef ||\n            !this._positions[index] ||\n            (!force && this._enableLoop())\n        ) {\n            return;\n        }\n\n        const offset = this._positions[index] && this._positions[index].start;\n\n        if (!offset && offset !== 0) {\n            return;\n        }\n\n        const itemsLength = data && data.length;\n        const direction = goTo || itemsLength === 1 ? \"start\" : \"end\";\n\n        this._scrollTo(offset + (direction === \"start\" ? -1 : 1), false);\n\n        clearTimeout(this._hackSlideAnimationTimeout);\n        this._hackSlideAnimationTimeout = setTimeout(() => {\n            this._scrollTo(offset, false);\n        }, 50); // works randomly when set to '0'\n    }\n\n    _lockScroll() {\n        const { lockScrollTimeoutDuration } = this.props;\n        clearTimeout(this._lockScrollTimeout);\n        this._lockScrollTimeout = setTimeout(() => {\n            this._releaseScroll();\n        }, lockScrollTimeoutDuration);\n        this._setScrollEnabled(false);\n    }\n\n    _releaseScroll() {\n        clearTimeout(this._lockScrollTimeout);\n        this._setScrollEnabled(true);\n    }\n\n    _repositionScroll(index) {\n        const { data, loopClonesPerSide } = this.props;\n        const dataLength = data && data.length;\n\n        if (\n            !this._enableLoop() ||\n            !dataLength ||\n            (index >= loopClonesPerSide && index < dataLength + loopClonesPerSide)\n        ) {\n            return;\n        }\n\n        let repositionTo = index;\n\n        if (index >= dataLength + loopClonesPerSide) {\n            repositionTo = index - dataLength;\n        } else if (index < loopClonesPerSide) {\n            repositionTo = index + dataLength;\n        }\n\n        this._snapToItem(repositionTo, false, false, false, false);\n    }\n\n    _scrollTo(offset, animated = true) {\n        const { vertical } = this.props;\n        const wrappedRef = this._getWrappedRef();\n\n        if (!this._mounted || !wrappedRef) {\n            return;\n        }\n\n        const specificOptions = this._needsScrollView()\n            ? {\n                x: vertical ? 0 : offset,\n                y: vertical ? offset : 0,\n            }\n            : {\n                offset,\n            };\n        const options = {\n            ...specificOptions,\n            animated,\n        };\n\n        if (this._needsScrollView()) {\n            wrappedRef.scrollTo(options);\n        } else {\n            wrappedRef.scrollToOffset(options);\n        }\n    }\n\n    _onScroll(event?) {\n        const { callbackOffsetMargin, enableMomentum, onScroll } = this.props;\n\n        const scrollOffset = event\n            ? this._getScrollOffset(event)\n            : this._currentContentOffset;\n        const nextActiveItem = this._getActiveItem(scrollOffset);\n        const itemReached = nextActiveItem === this._itemToSnapTo;\n        const scrollConditions =\n            scrollOffset >= this._scrollOffsetRef - callbackOffsetMargin &&\n            scrollOffset <= this._scrollOffsetRef + callbackOffsetMargin;\n\n        this._currentContentOffset = scrollOffset;\n        this._onScrollTriggered = true;\n        this._lastScrollDate = Date.now();\n\n        if (\n            this._activeItem !== nextActiveItem &&\n            this._shouldUseCustomAnimation()\n        ) {\n            this._playCustomSlideAnimation(this._activeItem, nextActiveItem);\n        }\n\n        if (enableMomentum) {\n            clearTimeout(this._snapNoMomentumTimeout);\n\n            if (this._activeItem !== nextActiveItem) {\n                this._activeItem = nextActiveItem;\n            }\n\n            if (itemReached) {\n                if (this._canFireBeforeCallback) {\n                    this._onBeforeSnap(this._getDataIndex(nextActiveItem));\n                }\n\n                if (scrollConditions && this._canFireCallback) {\n                    this._onSnap(this._getDataIndex(nextActiveItem));\n                }\n            }\n        } else if (this._activeItem !== nextActiveItem && itemReached) {\n            if (this._canFireBeforeCallback) {\n                this._onBeforeSnap(this._getDataIndex(nextActiveItem));\n            }\n\n            if (scrollConditions) {\n                this._activeItem = nextActiveItem;\n\n                if (this._canLockScroll()) {\n                    this._releaseScroll();\n                }\n\n                if (this._canFireCallback) {\n                    this._onSnap(this._getDataIndex(nextActiveItem));\n                }\n            }\n        }\n\n        if (\n            nextActiveItem === this._itemToSnapTo &&\n            scrollOffset === this._scrollOffsetRef\n        ) {\n            this._repositionScroll(nextActiveItem);\n        }\n\n        if (typeof onScroll === \"function\" && event) {\n            onScroll(event);\n        }\n    }\n\n    _onStartShouldSetResponderCapture(event) {\n        const { onStartShouldSetResponderCapture } = this.props;\n\n        if (onStartShouldSetResponderCapture) {\n            onStartShouldSetResponderCapture(event);\n        }\n\n        return this._getScrollEnabled();\n    }\n\n    _onTouchStart() {\n        const { onTouchStart } = this.props;\n\n        // `onTouchStart` is fired even when `scrollEnabled` is set to `false`\n        if (this._getScrollEnabled() !== false && this._autoplaying) {\n            this.pauseAutoPlay();\n        }\n\n        if (onTouchStart) {\n            onTouchStart();\n        }\n    }\n\n    _onTouchEnd() {\n        const { onTouchEnd } = this.props;\n\n        if (\n            this._getScrollEnabled() !== false &&\n            this._autoplay &&\n            !this._autoplaying\n        ) {\n            // This event is buggy on Android, so a fallback is provided in _onScrollEnd()\n            this.startAutoplay();\n        }\n\n        if (onTouchEnd) {\n            onTouchEnd();\n        }\n    }\n\n    // Used when `enableSnap` is ENABLED\n    _onScrollBeginDrag(event) {\n        const { onScrollBeginDrag } = this.props;\n\n        if (!this._getScrollEnabled()) {\n            return;\n        }\n\n        this._scrollStartOffset = this._getScrollOffset(event);\n        this._scrollStartActive = this._getActiveItem(this._scrollStartOffset);\n        this._ignoreNextMomentum = false;\n        // this._canFireCallback = false;\n\n        if (onScrollBeginDrag) {\n            onScrollBeginDrag(event);\n        }\n    }\n\n    // Used when `enableMomentum` is DISABLED\n    _onScrollEndDrag(event) {\n        const { onScrollEndDrag } = this.props;\n\n        if (this._carouselRef) {\n            this._onScrollEnd && this._onScrollEnd();\n        }\n\n        if (onScrollEndDrag) {\n            onScrollEndDrag(event);\n        }\n    }\n\n    // Used when `enableMomentum` is ENABLED\n    _onMomentumScrollEnd(event) {\n        const { onMomentumScrollEnd } = this.props;\n\n        if (this._carouselRef) {\n            this._onScrollEnd && this._onScrollEnd();\n        }\n\n        if (onMomentumScrollEnd) {\n            onMomentumScrollEnd(event);\n        }\n    }\n\n    _onScrollEnd(event?) {\n        const { autoplayDelay, enableSnap } = this.props;\n\n        if (this._ignoreNextMomentum) {\n            // iOS fix\n            this._ignoreNextMomentum = false;\n            return;\n        }\n\n        if (this._currentContentOffset === this._scrollEndOffset) {\n            return;\n        }\n\n        this._scrollEndOffset = this._currentContentOffset;\n        this._scrollEndActive = this._getActiveItem(this._scrollEndOffset);\n\n        if (enableSnap) {\n            this._snapScroll(this._scrollEndOffset - this._scrollStartOffset);\n        }\n\n        // The touchEnd event is buggy on Android, so this will serve as a fallback whenever needed\n        // https://github.com/facebook/react-native/issues/9439\n        if (this._autoplay && !this._autoplaying) {\n            clearTimeout(this._enableAutoplayTimeout);\n            this._enableAutoplayTimeout = setTimeout(() => {\n                this.startAutoplay();\n            }, autoplayDelay + 50);\n        }\n    }\n\n    // Due to a bug, this event is only fired on iOS\n    // https://github.com/facebook/react-native/issues/6791\n    // it's fine since we're only fixing an iOS bug in it, so ...\n    _onTouchRelease(event) {\n        const { enableMomentum } = this.props;\n\n        if (enableMomentum && IS_IOS) {\n            clearTimeout(this._snapNoMomentumTimeout);\n            this._snapNoMomentumTimeout = setTimeout(() => {\n                this._snapToItem(this._activeItem);\n            }, 100);\n        }\n    }\n\n    _onLayout(event) {\n        const { onLayout } = this.props;\n\n        // Prevent unneeded actions during the first 'onLayout' (triggered on init)\n        if (this._onLayoutInitDone) {\n            this._initPositionsAndInterpolators();\n            this._snapToItem(this._activeItem, false, false, false, false);\n        } else {\n            this._onLayoutInitDone = true;\n        }\n\n        if (onLayout) {\n            onLayout(event);\n        }\n    }\n\n    _snapScroll(delta) {\n        const { swipeThreshold } = this.props;\n\n        // When using momentum and releasing the touch with\n        // no velocity, scrollEndActive will be undefined (iOS)\n        if (!this._scrollEndActive && this._scrollEndActive !== 0 && IS_IOS) {\n            this._scrollEndActive = this._scrollStartActive;\n        }\n\n        if (this._scrollStartActive !== this._scrollEndActive) {\n            // Snap to the new active item\n            this._snapToItem(this._scrollEndActive);\n        } else {\n            // Snap depending on delta\n            if (delta > 0) {\n                if (delta > swipeThreshold) {\n                    this._snapToItem(this._scrollStartActive + 1);\n                } else {\n                    this._snapToItem(this._scrollEndActive);\n                }\n            } else if (delta < 0) {\n                if (delta < -swipeThreshold) {\n                    this._snapToItem(this._scrollStartActive - 1);\n                } else {\n                    this._snapToItem(this._scrollEndActive);\n                }\n            } else {\n                // Snap to current\n                this._snapToItem(this._scrollEndActive);\n            }\n        }\n    }\n\n    _snapToItem(\n        index,\n        animated = true,\n        fireCallback = true,\n        initial = false,\n        lockScroll = true\n    ) {\n        const { enableMomentum, onSnapToItem, onBeforeSnapToItem } = this.props;\n        const itemsLength = this._getCustomDataLength();\n        const wrappedRef = this._getWrappedRef();\n\n        if (!itemsLength || !wrappedRef) {\n            return;\n        }\n\n        if (!index || index < 0) {\n            index = 0;\n        } else if (itemsLength > 0 && index >= itemsLength) {\n            index = itemsLength - 1;\n        }\n\n        if (index !== this._previousActiveItem) {\n            this._previousActiveItem = index;\n\n            // Placed here to allow overscrolling for edges items\n            if (lockScroll && this._canLockScroll()) {\n                this._lockScroll();\n            }\n\n            if (fireCallback) {\n                if (onBeforeSnapToItem) {\n                    this._canFireBeforeCallback = true;\n                }\n\n                if (onSnapToItem) {\n                    this._canFireCallback = true;\n                }\n            }\n        }\n\n        this._itemToSnapTo = index;\n        this._scrollOffsetRef =\n            this._positions[index] && this._positions[index].start;\n        this._onScrollTriggered = false;\n\n        if (!this._scrollOffsetRef && this._scrollOffsetRef !== 0) {\n            return;\n        }\n\n        this._scrollTo(this._scrollOffsetRef, animated);\n\n        this._scrollEndOffset = this._currentContentOffset;\n\n        if (enableMomentum) {\n            // iOS fix, check the note in the constructor\n            if (!initial) {\n                this._ignoreNextMomentum = true;\n            }\n\n            // When momentum is enabled and the user is overscrolling or swiping very quickly,\n            // 'onScroll' is not going to be triggered for edge items. Then callback won't be\n            // fired and loop won't work since the scrollview is not going to be repositioned.\n            // As a workaround, '_onScroll()' will be called manually for these items if a given\n            // condition hasn't been met after a small delay.\n            // WARNING: this is ok only when relying on 'momentumScrollEnd', not with 'scrollEndDrag'\n            if (index === 0 || index === itemsLength - 1) {\n                clearTimeout(this._edgeItemTimeout);\n                this._edgeItemTimeout = setTimeout(() => {\n                    if (\n                        !initial &&\n                        index === this._activeItem &&\n                        !this._onScrollTriggered\n                    ) {\n                        this._onScroll();\n                    }\n                }, 250);\n            }\n        }\n    }\n\n    _onBeforeSnap(index) {\n        const { onBeforeSnapToItem } = this.props;\n\n        if (!this._carouselRef) {\n            return;\n        }\n\n        this._canFireBeforeCallback = false;\n        onBeforeSnapToItem && onBeforeSnapToItem(index);\n    }\n\n    _onSnap(index) {\n        const { onSnapToItem } = this.props;\n\n        if (!this._carouselRef) {\n            return;\n        }\n\n        this._canFireCallback = false;\n        onSnapToItem && onSnapToItem(index);\n    }\n\n    startAutoplay() {\n        const { autoplayInterval, autoplayDelay } = this.props;\n        this._autoplay = true;\n\n        if (this._autoplaying) {\n            return;\n        }\n\n        clearTimeout(this._autoplayTimeout);\n        this._autoplayTimeout = setTimeout(() => {\n            this._autoplaying = true;\n            this._autoplayInterval = setInterval(() => {\n                if (this._autoplaying) {\n                    this.snapToNext();\n                }\n            }, autoplayInterval);\n        }, autoplayDelay);\n    }\n\n    pauseAutoPlay() {\n        this._autoplaying = false;\n        clearTimeout(this._autoplayTimeout);\n        clearTimeout(this._enableAutoplayTimeout);\n        clearInterval(this._autoplayInterval);\n    }\n\n    stopAutoplay() {\n        this._autoplay = false;\n        this.pauseAutoPlay();\n    }\n\n    snapToItem(index, animated = true, fireCallback = true) {\n        if (!index || index < 0) {\n            index = 0;\n        }\n\n        const positionIndex = this._getPositionIndex(index);\n\n        if (positionIndex === this._activeItem) {\n            return;\n        }\n\n        this._snapToItem(positionIndex, animated, fireCallback);\n    }\n\n    snapToNext(animated = true, fireCallback = true) {\n        const itemsLength = this._getCustomDataLength();\n\n        let newIndex = this._activeItem + 1;\n        if (newIndex > itemsLength - 1) {\n            if (!this._enableLoop()) {\n                return;\n            }\n            newIndex = 0;\n        }\n        this._snapToItem(newIndex, animated, fireCallback);\n    }\n\n    snapToPrev(animated = true, fireCallback = true) {\n        const itemsLength = this._getCustomDataLength();\n\n        let newIndex = this._activeItem - 1;\n        if (newIndex < 0) {\n            if (!this._enableLoop()) {\n                return;\n            }\n            newIndex = itemsLength - 1;\n        }\n        this._snapToItem(newIndex, animated, fireCallback);\n    }\n\n    // https://github.com/facebook/react-native/issues/1831#issuecomment-231069668\n    triggerRenderingHack(offset) {\n        // Avoid messing with user scroll\n        if (Date.now() - this._lastScrollDate < 500) {\n            return;\n        }\n\n        const scrollPosition = this._currentContentOffset;\n        if (!scrollPosition && scrollPosition !== 0) {\n            return;\n        }\n\n        const scrollOffset = offset || (scrollPosition === 0 ? 1 : -1);\n        this._scrollTo(scrollPosition + scrollOffset, false);\n    }\n\n    _getSlideInterpolatedStyle(index, animatedValue) {\n        const { layoutCardOffset, slideInterpolatedStyle } = this.props;\n\n        if (slideInterpolatedStyle) {\n            return slideInterpolatedStyle(index, animatedValue, this.props);\n        } else if (this._shouldUseTinderLayout()) {\n            return tinderAnimatedStyles(\n                index,\n                animatedValue,\n                this.props,\n                layoutCardOffset\n            );\n        } else if (this._shouldUseStackLayout()) {\n            return stackAnimatedStyles(\n                index,\n                animatedValue,\n                this.props,\n                layoutCardOffset\n            );\n        } else if (this._shouldUseShiftLayout()) {\n            return shiftAnimatedStyles(index, animatedValue, this.props);\n        } else {\n            return defaultAnimatedStyles(index, animatedValue, this.props);\n        }\n    }\n\n    _renderItem({ item, index }) {\n        const { interpolators } = this.state;\n        const {\n            hasParallaxImages,\n            itemWidth,\n            itemHeight,\n            keyExtractor,\n            renderItem,\n            sliderHeight,\n            sliderWidth,\n            slideStyle,\n            vertical,\n        } = this.props;\n\n        const animatedValue = interpolators && interpolators[index];\n\n        if (!animatedValue && animatedValue !== 0) {\n            return null;\n        }\n\n        const animate = this._shouldAnimateSlides();\n        const Component = animate ? Animated.View : View;\n        const animatedStyle = animate\n            ? this._getSlideInterpolatedStyle(index, animatedValue)\n            : {};\n\n        const parallaxProps = hasParallaxImages\n            ? {\n                scrollPosition: this._scrollPos,\n                carouselRef: this._carouselRef,\n                vertical,\n                sliderWidth,\n                sliderHeight,\n                itemWidth,\n                itemHeight,\n            }\n            : undefined;\n\n        const mainDimension = vertical\n            ? { height: itemHeight }\n            : { width: itemWidth };\n        const specificProps = this._needsScrollView()\n            ? {\n                key: keyExtractor\n                    // @ts-ignore\n                    ? keyExtractor(item, index)\n                    : this._getKeyExtractor(item, index),\n            }\n            : {};\n\n        return (\n            <Component\n                style={[mainDimension, slideStyle, animatedStyle] as any}\n                pointerEvents={\"box-none\"}\n                {...specificProps}\n            >\n                {renderItem({ item, index }, parallaxProps)}\n            </Component>\n        );\n    }\n\n    _getComponentOverridableProps = (): any => {\n        const {\n            enableMomentum,\n            itemWidth,\n            itemHeight,\n            loopClonesPerSide,\n            sliderWidth,\n            sliderHeight,\n            vertical,\n        } = this.props;\n\n        const visibleItems =\n            Math.ceil(\n                vertical ? sliderHeight / itemHeight : sliderWidth / itemWidth\n            ) + 1;\n        const initialNumPerSide = this._enableLoop() ? loopClonesPerSide : 2;\n        const initialNumToRender = visibleItems + initialNumPerSide * 2;\n        const maxToRenderPerBatch = 1 + initialNumToRender * 2;\n        const windowSize = maxToRenderPerBatch;\n\n        const specificProps = !this._needsScrollView()\n            ? {\n                initialNumToRender: initialNumToRender,\n                maxToRenderPerBatch: maxToRenderPerBatch,\n                windowSize: windowSize,\n                // updateCellsBatchingPeriod\n            }\n            : {};\n\n        return {\n            decelerationRate: enableMomentum ? 0.9 : \"fast\",\n            showsHorizontalScrollIndicator: false,\n            showsVerticalScrollIndicator: false,\n            overScrollMode: \"never\",\n            automaticallyAdjustContentInsets: false,\n            directionalLockEnabled: true,\n            pinchGestureEnabled: false,\n            scrollsToTop: false,\n            removeClippedSubviews: !this._needsScrollView(),\n            inverted: this._needsRTLAdaptations(),\n            // renderToHardwareTextureAndroid: true,\n            ...specificProps,\n        };\n    }\n\n    _getComponentStaticProps() {\n        const { hideCarousel } = this.state;\n        const {\n            containerCustomStyle,\n            contentContainerCustomStyle,\n            keyExtractor,\n            sliderWidth,\n            sliderHeight,\n            style,\n            vertical,\n        } = this.props;\n\n        const containerStyle = [\n            containerCustomStyle || style || {},\n            hideCarousel ? { opacity: 0 } : {},\n            vertical\n                ? { height: sliderHeight, flexDirection: \"column\" }\n                : // LTR hack; see https://github.com/facebook/react-native/issues/11960\n                // and https://github.com/facebook/react-native/issues/13100#issuecomment-328986423\n                {\n                    width: sliderWidth,\n                    flexDirection: this._needsRTLAdaptations() ? \"row-reverse\" : \"row\",\n                },\n        ];\n        const contentContainerStyle = [\n            vertical\n                ? {\n                    paddingTop: this._getContainerInnerMargin(),\n                    paddingBottom: this._getContainerInnerMargin(true),\n                }\n                : {\n                    paddingLeft: this._getContainerInnerMargin(),\n                    paddingRight: this._getContainerInnerMargin(true),\n                },\n            contentContainerCustomStyle || {},\n        ];\n\n        const specificProps = !this._needsScrollView()\n            ? {\n                // extraData: this.state,\n                renderItem: this._renderItem,\n                numColumns: 1,\n                keyExtractor: keyExtractor || this._getKeyExtractor,\n            }\n            : {};\n\n        return {\n            ref: c => (this._carouselRef = c),\n            data: this._getCustomData(),\n            style: containerStyle,\n            contentContainerStyle: contentContainerStyle,\n            horizontal: !vertical,\n            scrollEventThrottle: 1,\n            onScroll: this._onScrollHandler,\n            onScrollBeginDrag: this._onScrollBeginDrag,\n            onScrollEndDrag: this._onScrollEndDrag,\n            onMomentumScrollEnd: this._onMomentumScrollEnd,\n            onResponderRelease: this._onTouchRelease,\n            onStartShouldSetResponderCapture: this._onStartShouldSetResponderCapture,\n            onTouchStart: this._onTouchStart,\n            onTouchEnd: this._onScrollEnd,\n            onLayout: this._onLayout,\n            ...specificProps,\n        };\n    }\n\n    render() {\n        const { data, renderItem, useScrollView } = this.props;\n\n        if (!data || !renderItem) {\n            return null;\n        }\n\n        const props = {\n            ...this._getComponentOverridableProps(),\n            ...this.props,\n            ...this._getComponentStaticProps(),\n        };\n\n        const ScrollViewComponent =\n            typeof useScrollView === \"function\" ? useScrollView : AnimatedScrollView;\n\n        return this._needsScrollView() ? (\n            // @ts-ignore\n            <ScrollViewComponent {...props}>\n                {this._getCustomData().map((item, index) => {\n                    return this._renderItem({ item, index });\n                })}\n            </ScrollViewComponent>\n        ) : (\n        // @ts-ignore\n            <AnimatedFlatList {...props} />\n        );\n    }\n}\n"]}