{"version":3,"sources":["ProgressBar.tsx"],"names":["React","Animated","Platform","StyleSheet","View","I18nManager","setColor","ThemeContext","INDETERMINATE_DURATION","INDETERMINATE_MAX_WIDTH","isRTL","ProgressBar","color","indeterminate","style","progress","visible","rest","theme","useContext","current","timer","useRef","Value","fade","width","setWidth","useState","prevWidth","setPrevWidth","indeterminateAnimation","scale","animation","startAnimation","useCallback","timing","duration","toValue","useNativeDriver","isInteraction","start","OS","setValue","loop","stopAnimation","stop","useEffect","onLayout","event","nativeEvent","layout","tintColor","colors","primary","trackTintColor","alpha","rgb","string","styles","container","backgroundColor","opacity","progressBar","transform","translateX","interpolate","inputRange","outputRange","scaleX","create","height","overflow","flex"],"mappings":"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","sourcesContent":["import * as React from \"react\";\r\nimport {\r\n    Animated,\r\n    Platform,\r\n    StyleSheet,\r\n    View,\r\n    ViewStyle,\r\n    StyleProp,\r\n    LayoutChangeEvent,\r\n    I18nManager,\r\n} from \"react-native\";\r\nimport setColor from \"color\";\r\nimport { DefaultTheme, ThemeContext } from \"styled-components\";\r\n\r\ntype Props = React.ComponentPropsWithRef<typeof View> & {\r\n    /**\r\n     * Progress value (between 0 and 1).\r\n     */\r\n    progress?: number;\r\n    /**\r\n     * Color of the progress bar. The background color will be calculated based on this but you can change it by passing `backgroundColor` to `style` prop.\r\n     */\r\n    color?: string;\r\n    /**\r\n     * If the progress bar will show indeterminate progress.\r\n     */\r\n    indeterminate?: boolean;\r\n    /**\r\n     * Whether to show the ProgressBar (true, the default) or hide it (false).\r\n     */\r\n    visible?: boolean;\r\n    style?: StyleProp<ViewStyle>;\r\n    /**\r\n     * @optional\r\n     */\r\n    theme?: DefaultTheme;\r\n};\r\n\r\nconst INDETERMINATE_DURATION = 2000;\r\nconst INDETERMINATE_MAX_WIDTH = 0.6;\r\nconst { isRTL } = I18nManager;\r\n\r\n/**\r\n * Progress bar is an indicator used to present progress of some activity in the app.\r\n *\r\n * <div class=\"screenshots\">\r\n *   <img src=\"screenshots/progress-bar.png\" />\r\n * </div>\r\n *\r\n * ## Usage\r\n * ```js\r\n * import * as React from 'react';\r\n * import ProgressBar from 'react-native-simple-elements/components/ProgressBar';\r\n * import * as Colors from \"react-native-simple-elements/components/theme/colors\";\r\n *\r\n * const MyComponent = () => (\r\n *   <ProgressBar progress={0.5} color={Colors.red800} />\r\n * );\r\n *\r\n * export default MyComponent;\r\n * ```\r\n */\r\nconst ProgressBar = ({\r\n    color,\r\n    indeterminate,\r\n    style,\r\n    progress = 0,\r\n    visible = true,\r\n    ...rest\r\n}: Props) => {\r\n    const theme = React.useContext(ThemeContext);\r\n    const { current: timer } = React.useRef<Animated.Value>(\r\n        new Animated.Value(0)\r\n    );\r\n    const { current: fade } = React.useRef<Animated.Value>(new Animated.Value(0));\r\n    const [width, setWidth] = React.useState<number>(0);\r\n    const [prevWidth, setPrevWidth] = React.useState<number>(0);\r\n\r\n    const indeterminateAnimation = React.useRef<Animated.CompositeAnimation | null>(\r\n        null\r\n    );\r\n\r\n    const { scale } = theme.animation;\r\n\r\n    const startAnimation = React.useCallback(() => {\r\n        // Show progress bar\r\n        Animated.timing(fade, {\r\n            duration: 200 * scale,\r\n            toValue: 1,\r\n            useNativeDriver: true,\r\n            isInteraction: false,\r\n        }).start();\r\n\r\n        // Animate progress bar\r\n        if (indeterminate) {\r\n            if (!indeterminateAnimation.current) {\r\n                indeterminateAnimation.current = Animated.timing(timer, {\r\n                    duration: INDETERMINATE_DURATION,\r\n                    toValue: 1,\r\n                    // Animated.loop does not work if useNativeDriver is true on web\r\n                    useNativeDriver: Platform.OS !== \"web\",\r\n                    isInteraction: false,\r\n                });\r\n            }\r\n\r\n            // Reset timer to the beginning\r\n            timer.setValue(0);\r\n\r\n            Animated.loop(indeterminateAnimation.current).start();\r\n        } else {\r\n            Animated.timing(timer, {\r\n                duration: 200 * scale,\r\n                toValue: progress ? progress : 0,\r\n                useNativeDriver: true,\r\n                isInteraction: false,\r\n            }).start();\r\n        }\r\n    }, [scale, timer, progress, indeterminate, fade]);\r\n\r\n    const stopAnimation = React.useCallback(() => {\r\n        // Stop indeterminate animation\r\n        if (indeterminateAnimation.current) {\r\n            indeterminateAnimation.current.stop();\r\n        }\r\n\r\n        Animated.timing(fade, {\r\n            duration: 200 * scale,\r\n            toValue: 0,\r\n            useNativeDriver: true,\r\n            isInteraction: false,\r\n        }).start();\r\n    }, [fade, scale]);\r\n\r\n    React.useEffect(() => {\r\n        if (visible) startAnimation();\r\n        else stopAnimation();\r\n    }, [visible, startAnimation, stopAnimation]);\r\n\r\n    React.useEffect(() => {\r\n        // Start animation the very first time when previously the width was unclear\r\n        if (visible && prevWidth === 0) {\r\n            startAnimation();\r\n        }\r\n    }, [prevWidth, startAnimation, visible]);\r\n\r\n    const onLayout = (event: LayoutChangeEvent) => {\r\n        setPrevWidth(width);\r\n        setWidth(event.nativeEvent.layout.width);\r\n    };\r\n\r\n    const tintColor = color || theme.colors.primary;\r\n    const trackTintColor = setColor(tintColor).alpha(0.38).rgb().string();\r\n\r\n    return (\r\n        <View\r\n            onLayout={onLayout}\r\n            {...rest}\r\n            accessible\r\n            accessibilityRole=\"progressbar\"\r\n        >\r\n            <Animated.View\r\n                style={[\r\n                    styles.container,\r\n                    { backgroundColor: trackTintColor, opacity: fade },\r\n                    style,\r\n                ]}\r\n            >\r\n                <Animated.View\r\n                    style={[\r\n                        styles.progressBar,\r\n                        {\r\n                            backgroundColor: tintColor,\r\n                            width,\r\n                            transform: [\r\n                                {\r\n                                    translateX: timer.interpolate(\r\n                                        indeterminate\r\n                                            ? {\r\n                                                inputRange: [0, 0.5, 1],\r\n                                                outputRange: [\r\n                                                    (isRTL ? 1 : -1) * 0.5 * width,\r\n                                                    (isRTL ? 1 : -1) *\r\n                                                    0.5 *\r\n                                                    INDETERMINATE_MAX_WIDTH *\r\n                                                    width,\r\n                                                    (isRTL ? -1 : 1) * 0.7 * width,\r\n                                                ],\r\n                                            }\r\n                                            : {\r\n                                                inputRange: [0, 1],\r\n                                                outputRange: [(isRTL ? 1 : -1) * 0.5 * width, 0],\r\n                                            }\r\n                                    ),\r\n                                },\r\n                                {\r\n                                    // Workaround for workaround for https://github.com/facebook/react-native/issues/6278\r\n                                    scaleX: timer.interpolate(\r\n                                        indeterminate\r\n                                            ? {\r\n                                                inputRange: [0, 0.5, 1],\r\n                                                outputRange: [\r\n                                                    0.0001,\r\n                                                    INDETERMINATE_MAX_WIDTH,\r\n                                                    0.0001,\r\n                                                ],\r\n                                            }\r\n                                            : {\r\n                                                inputRange: [0, 1],\r\n                                                outputRange: [0.0001, 1],\r\n                                            }\r\n                                    ),\r\n                                },\r\n                            ],\r\n                        },\r\n                    ]}\r\n                />\r\n            </Animated.View>\r\n        </View>\r\n    );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        height: 4,\r\n        overflow: \"hidden\",\r\n    },\r\n\r\n    progressBar: {\r\n        flex: 1,\r\n    },\r\n});\r\n\r\nexport default ProgressBar;\r\n"]}